name: build-evilwoods-binary-cache
on:
  push:
    branches: ["main"]
    paths:
      - "bootc/evilwoods-binary-cache/**"
  workflow_dispatch:

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: "evilwoods-binary-cache"
  IMAGE_REGISTRY: ghcr.io/${{ github.repository_owner }}
  REGISTRY_USER: ${{ github.actor }}
  REGISTRY_PASSWORD: ${{ github.token }}

jobs:
  podman-build:
    permissions:
      packages: write
      contents: read
    uses: ./.github/workflows/evilwoods-common.yml
    with:
      num-packages-to-keep: 2
      image-name: "evilwoods-binary-cache"
    secrets: inherit
